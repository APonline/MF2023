<div id="messenger" [ngClass]="messenger ? 'active' : ''">
  <div class="glassSolid" style="padding:0px;">
    <button id="messengerBtn" class="material-icons" title='Messenger' (click)="openMessenger()">
      chat <span class="mat-icon-word">MF Messenger</span> <span><i class="material-icons">{{chaticon}}</i></span>
    </button>

    <h3 style="padding:20px;">Online Users</h3>

    <div class="box">
      <div class="list" *ngFor="let user of userList$" (click)="goToChat(user)">
        <div class="imgBox">
          <img *ngIf="user?.profile_image == 'default'; else hasImage" src="./assets/images/defaultprofile.png"  />
            <ng-template #hasImage>
              <img src="{{ user?.display?.display}}" alt="{{ user?.display?.name}}" />
            </ng-template>
        </div>
        <div class="content">
          <!-- <h2 class="rank"><small>#</small>1</h2> -->
          <h4>{{user.username}}</h4>
          <p>{{user.firstname}} {{user.lastname}}</p>
        </div>
      </div>
    </div>

    <div class="box chat" [ngClass]="{'': mode != 'chat', 'active': mode == 'chat', 'hidden': !messenger, 'show': messenger}">
      <div class="currUser">
        <div class="currUserTop">
          <div class="backtoList" (click)="closeChat()">
            <i class="material-icons" >arrow_back_ios_new</i>
          </div>
          <div class="imgBox">
            <img *ngIf="currChatUser?.profile_image == 'default'; else hasImage" src="./assets/images/defaultprofile.png"  />
              <ng-template #hasImage>
                <img src="{{ currChatUser?.display?.display}}" alt="{{ currChatUser?.display?.name}}" />
              </ng-template>
          </div>
          <div class="content">
            <h4>{{currChatUser.username}}</h4>
            <p>{{currChatUser.firstname}} {{currChatUser.lastname}}</p>
          </div>
        </div>
      </div>

      <div class="chat-log" #scrollMe>

        <ng-container *ngFor="let chat of currChatLog">
          <div class="chatMsgContainer">
            <div class="blurb tri-right" [ngClass]="chat.userId != currChatUser.id ? 'sender right-in':'receiver left-in'">
              <p class="body" [innerHTML]="chat.body | sanitizeHtml">
              </p>
              <span class="timestamp">{{chat.date}} {{chat.time}}</span>
            </div>
          </div>

        </ng-container>

        <ng-container *ngFor="let chat of currNewChatLog">
          <div class="chatMsgContainer">
            <div class="blurb tri-right" [ngClass]="chat.userId != currChatUser.id ? 'sender right-in':'receiver left-in'">
              <p class="body" [innerHTML]="chat.body | sanitizeHtml">
              </p>
              <span class="timestamp">{{chat.date}} {{chat.time}}</span>
            </div>
          </div>
        </ng-container>

        <div class="blurb typing tri-right receiver left-in" *ngIf="currIsTyping">
          <svg height="40" width="40">
            <circle class="dot" cx="10" cy="20" r="3" style="fill:grey;" />
            <circle class="dot" cx="20" cy="20" r="3" style="fill:grey;" />
            <circle class="dot" cx="30" cy="20" r="3" style="fill:grey;" />
          </svg>
        </div>
      </div>
      <div class="chat-input">
          <input type="text" [(ngModel)]="myMsg" name="chatMsg" placeholder="msg..."
          (keyup)="isTyping($event.target.value)"
          (keyup.enter)="hasTyped()" />
          <button class="msgSubmit" (click)="hasTyped()">
            <i class="material-icons">send</i>
          </button>

      </div>
    </div>
  </div>
</div>
